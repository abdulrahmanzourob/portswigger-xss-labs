 

## 1.علومات عامة

| العنصر         | التفاصيل                                                                                                                   |
| -------------- | -------------------------------------------------------------------------------------------------------------------------- |
| **الرابط**     | [رابط اللاب](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-attribute-angle-brackets-html-encoded) |
| **تاريخ الحل** | 28/4                                                                                                                       |
| **نوع الثغرة** | Reflected-Based XSS                                                                                                        |

---

## أولاً: فهم سيناريو اللاب

- الموقع فيه خانة **بحث**.

- لما تكتب أي كلمة وتضغط **Search**، الكلمة بتنعكس في صفحة النتائج.

    ![[Pasted image 20250428001854.png]]

- بس المهم: الموقع بيعمل **HTML encoding** للـ **angle brackets** `< >` (يعني بيحولهم إلى `&lt;` و `&gt;`) علشان يمنع أنك تكتب تاجات HTML مباشرة.

![[Pasted image 20250428002048.png]]
    
- طيب... بما إن `<` و `>` مؤمنين (مستحيل تفتح تاج جديد)، هل لسه نقدر نعمل XSS؟
    
- **نعم**! والسبب هو إن الـ input بتاعنا بيتحقن جوه **Attribute** (تحديدًا جوه `value` بتاع `<input>`)، مش جوه نص عادي.
    

---

## ثانيًا: مكان الانعكاس في الكود

شوف الكود اللي انت جبته:

```html
<input type=text placeholder='Search the blog...' name=search value=""onmouseover="alert(1)">
```

- الـ input اللي انت دخلته (`"onmouseover="alert(1)`) اتحقن جوه الـ **value** بتاع العنصر.
    
- النتيجة النهائية بقت إن فيه **Attribute Injection**.
    
- يعني بدل ما يكون `value="نص عادي"`، بقى:
    
    - `value="" onmouseover="alert(1)"`
        

فـ فعليًا خلقت **Attribute جديد** اسمه `onmouseover`! وده **حدث (Event Handler)** بيشغل الكود لما الماوس يمر على العنصر.

---

## ثالثًا: شرح الـ Payload بالضبط

### ليه استخدمنا `"onmouseover="alert(1)`؟

- أول `"` (علامة اقتباس) **تقفل** الـ `value="..."` اللي كنت جوهها.
    
- بعد كده كتبت `onmouseover="alert(1)"` كأنه **Attribute جديد** في العنصر.
    
- فبكده حصل إنه:
    
    1. قفلنا القيمة الأصلية.
        
    2. أضفنا حدث جديد (onmouseover).
        
    3. كتبنا الكود اللي عايزينه (`alert(1)`).
        

---

## رابعًا: خطوات الحل بالتفصيل

1. كتبت أي كلمة في البحث (مثلاً `test`) وضغطت Search.
    ![[Pasted image 20250428001854.png]]
2. شفت إن الكلمة انعكست في كود HTML في مكان **value**.
    ![[Pasted image 20250428002048.png]]

3. بدلت الكلمة اللي كتبتها بالـ Payload:
```js
 "onmouseover="alert(1)
```

![[Pasted image 20250428002642.png]]

فلما ضغط على ال`inputbox` اشغل ال alert

---

## خامسًا: أمثلة تانية على نفس الفكرة

مش شرط دايمًا تستخدم `onmouseover`، ممكن تستخدم أي حدث تاني. أمثلة:

|الحدث|متى بيشتغل|مثال payload|
|---|---|---|
|`onfocus`|لما العنصر ياخد focus (مثلاً لما تضغط عليه)|`"onfocus="alert(1)`|
|`onclick`|لما تدوس كليك|`"onclick="alert(1)`|
|`oninput`|لما تكتب داخل العنصر|`"oninput="alert(1)`|
|`onmouseenter`|لما الماوس يدخل العنصر|`"onmouseenter="alert(1)`|

كل دي تعتمد على نفس الفكرة:  
**تقفل القوس " وتضيف Event جديد**.

لتفصيل اكتر ← [[جدول بالعناصر الشائعة + أفضل الـ Events المناسبة لكل عنصر في XSS]]
[[Advanced Cases]]

---

## سادسًا: ليه لازم تركز على أنواع الـ Attributes؟

- مش كل العناصر تقبل كل الأحداث.

- مثلا: `<input>` العنصر ممكن يقبل `onfocus`, `onmouseover`, `oninput`, لكن مش `onload`.

- `<img>` العنصر يقبل `onerror`.

- `<body>` يقبل `onload`.


فعشان كده لازم تفهم نوع العنصر عشان تختار الـ Event المناسب.

---

## سابعًا: ملخص سريع

- **مشكلة الموقع**: ماكانش بيأمن **الإدخال داخل خصائص Attributes**.
    
- **الحل**: قفلنا الـ Attribute اللي احنا فيه وحقنا Attribute جديد.
    
- **الخطوات**:
    
    1. إرسال input عشوائي.
        
    2. رؤية مكان الانعكاس.
        
    3. حقن payload فيه `"` لقفل الاقتباس و Event Handler زي `onmouseover`.
        
    4. اختبار الكود.
        
