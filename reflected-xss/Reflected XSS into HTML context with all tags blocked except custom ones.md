## 1๏ธโฃ ูุนูููุงุช ุนุงูุฉ

|ุงูุนูุตุฑ|ุงูุชูุงุตูู|
|---|---|
|**ุฑุงุจุท ุงููุงุจ**|[HTML context with all standard tags blocked](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-all-standard-tags-blocked)|
|**ุชุงุฑูุฎ ุงูุญู**|2 / 5 / 2025|
|**ููุน ุงูุซุบุฑุฉ**|Reflected Cross-Site Scripting (XSS)|

---

## ๐ฐ ูุตู ุงููุงุจ

- ูุฐุง ุงููุงุจ ูููุน ุงุณุชุฎุฏุงู ุฌููุน ุนูุงุตุฑ HTML ุงูููุงุณูุฉ (standard tags) ูุซู `<script>`, `<img>`... ุฅูุฎ.
    
- ููุณูุญ ููุท ุจุงุณุชุฎุฏุงู ุนูุงุตุฑ HTML **ุงููุฎุตุตุฉ (custom tags)**.
    
- ุงููุฏู ูู ุชูููุฐ ูุฌูู XSS ูุธูุฑ ููู `alert(document.cookie)` **ุจุดูู ุชููุงุฆู** ุฏูู ุชูุงุนู ูู ุงููุณุชุฎุฏู.
    

---

## 2๏ธโฃ ููู ุณููุงุฑูู ุงููุงุจ

- ุงููููุน ูุญุชูู ุนูู ุฎุงูุฉ **ุจุญุซ**ุ ูุนูุฏ ุฅุฏุฎุงู ูููุฉ ูุชู ุนุฑุถูุง ุฏุงุฎู ุตูุญุฉ ุงููุชุงุฆุฌ.

    ![Screenshot](../images/Screenshot%202025-05-02%20151705.png)
- ุฃู ุฅุฏุฎุงู ูุชู ุนุฑุถู ุฏุงุฎู ุงูุตูุญุฉ ุจุฏูู ุชุฑููุฒ (escaping) ููุงุณุจ.
    
- ููู ุงูููุชุฑ ูููุน ุฌููุน ุงูุชุงุฌุงุช ุงูููุงุณูุฉุ ููุง ููุฑุถ ุนูููุง ุงุณุชุฎุฏุงู **custom tag**.

    ![Screenshot](../images/Screenshot%202025-05-02%20153527.png)

---

## โ ูุง ูู ุงูู Custom Tagุ

- ูู ุนูุตุฑ HTML ุบูุฑ ููุงุณูุ ููุนุฑู ุฃูุถูุง ุจุงุณู **custom element**ุ ูููุณุชุฎุฏู ุถูู ููููุงุช ุงูููุจ (Web Components).
    
- ูุฌุจ ุฃู ูุญุชูู ุงุณูู ุนูู **dash `-`** ูุซู: `<my-element>`ุ ุญุชู ูุง ูุชุนุงุฑุถ ูุน ุนูุงุตุฑ HTML ุงูุฃุตููุฉ.
    
- ูููู ุฃู ูุญูู ุฎุตุงุฆุต (`attributes`) ูุฃุญุฏุงุซ (`events`) ุชูุงููุง ูุซู ุฃู ุนูุตุฑ HTML ุขุฎุฑ.
    

๐งช **ูุซุงู:**

```html
<xss id="x" tabindex="1" onfocus="alert(document.cookie)">#x</xss>
```

---

## 3๏ธโฃ ุชุญููู ุงูุจุงูููุฏ

```html
<xss id="x" tabindex="1" onfocus="alert(document.cookie)">#x</xss>
```

|ุงูุฌุฒุก|ุงูุดุฑุญ|
|---|---|
|`<xss>`|ุนูุตุฑ ูุฎุตุต (custom tag) ุบูุฑ ูููุชุฑ.|
|`id="x"`|ููุณุชุฎุฏู ูููุตูู ุฅูู ุงูุนูุตุฑ ุนุจุฑ ุงูู fragment (`#x`).|
|`tabindex="1"`|ูุฌุนู ุงูุนูุตุฑ ูุงุจููุง ููุชุฑููุฒ (focus).|
|`onfocus="alert(...)"`|ูุชู ุชูููุฐ ุงูููุฏ ุนูุฏ ุญุตูู focus ุนูู ุงูุนูุตุฑ.|
|`#x`|ูุต ูุธูุฑ ุฏุงุฎู ุงูุนูุตุฑุ ููุณุงุนุฏ ุนูู ุธููุฑู ุฏุงุฎู ุงูุตูุญุฉ.|

---

## 4๏ธโฃ ุขููุฉ ุชูููุฐ ุงูููุฏ ุชููุงุฆููุง

ุนูุฏ ุฒูุงุฑุฉ ุฑุงุจุท ูุญุชูู ุนูู:

```txt
#x
```

ุงููุชุตูุญ ุชููุงุฆููุง:

1. ูุจุญุซ ุนู ุงูุนูุตุฑ ุงูุฐู `id="x"`.
    
2. ูููู ุจุนูู **focus ุชููุงุฆู** ุนููู.
    
3. ูุจูุง ุฃู ุงูุนูุตุฑ ูุญุชูู ุนูู `onfocus=alert(...)` โ ูุชู ุชูููุฐ ุงูููุฏ ููุฑูุง.
    

โ **ุงููุชูุฌุฉ:** ูุชู ุชุดุบูู XSS ุจุฏูู ุฃู ุชูุงุนู ูู ุงูุถุญูุฉ.

---

## 5๏ธโฃ ุงูููุฏ ุงููุงูู ููุชูููุฐ ุงูุชููุงุฆู

```html
<script>
location = "https://TARGET-LAB/?search=<xss id=x tabindex=1 onfocus=alert(document.cookie)>#x"
</script>
```

### ๐ ุดุฑุญ ุงูููุฏ:

|ุงูุนูุตุฑ|ุงูุดุฑุญ|
|---|---|
|`<script>`|ุนูุตุฑ ุฌุงูุงุณูุฑูุจุช ูุชู ุชูููุฐู ูุจุงุดุฑุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ.|
|`location =`|ูููู ุจุชุญููู ุงููุชุตูุญ ุชููุงุฆููุง ุฅูู ุฑุงุจุท ูุญุชูู ุนูู ุงูุจุงูููุฏ.|
|`?search=...`|ุงูุจุงุฑุงููุชุฑ ุงููุตุงุจ ุงูุฐู ูุนุฑุถ ูุง ุจุฏุงุฎูู ุฏุงุฎู ุงูุตูุญุฉ ุฏูู ุชุฑููุฒ.|
|`#x`|fragment ููุฌู ุงููุชุตูุญ ููุนูุตุฑ ุงูุฐู `id="x"` ููุนุทูู focusุ ููุง ูุคุฏู ูุชุดุบูู `onfocus`.|

---

## 6๏ธโฃ ููุงุฐุง ูุชู ุงุณุชุฎุฏุงู `location` ูู ุณูุฑุจุช ูููุตูุ

- ุจุนุถ ุงููุฎุชุจุฑุงุช ุชุชุทูุจ ุฃู ูุชู ุชุดุบูู ุงูู XSS **ูู ุงูุณูุงู ุงููุงูู ููุถุญูุฉ**.
    
- ูุชู ุฅูุดุงุก ุตูุญุฉ redirect ุชุญุชูู ุนูู ุงูุณูุฑุจุช ุงูุณุงุจู.
    
- ุนูุฏ ุฒูุงุฑุฉ ุงูุถุญูุฉ ููุตูุญุฉุ ูุชู ุฅุนุงุฏุฉ ุชูุฌููู ุชููุงุฆููุง ููุฑุงุจุท ุงููุตุงุจ ูููููุฐ ุงูููุฏ.
    

---

## 7๏ธโฃ ุงููุงุฆุฏุฉ ุงูุฃูููุฉ ูู ูุฐุง ุงูุฃุณููุจ

- **ูุชุฎุทู ุงูููุงุชุฑ** ุงูุชู ุชููุน ุนูุงุตุฑ ูุซู `<script>`, `<img>`, `onerror`... ุฅูุฎ.
    
- **ุจุณูุท** ููููู ุงุณุชุบูุงูู ุญุชู ูู ูุงูุช ุงูุญูุงูุฉ ุชุนุชูุฏ ุนูู ุญุธุฑ ุงูุชุงุฌุงุช ุงูููุงุณูุฉ ููุท.
    
- ููููู ุงุณุชุฎุฏุงูู ูู ุณููุงุฑูููุงุช **ุญููููุฉ** ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุฒูุฑ ุฑุงุจุท ูุชู ุงูุชุญูู ููู (social engineering).
    

---

## โ ููุฎุต ุณุฑูุน

|ุงูุนูุตุฑ|ุงููุธููุฉ|
|---|---|
|`<xss>`|ุนูุตุฑ ูุฎุตุต ุบูุฑ ูููุชุฑ.|
|`id="x"`|ูุชุญุฏูุฏ ุงูุนูุตุฑ ุนุจุฑ `#x`.|
|`tabindex=1`|ูุฌุนู ุงูุนูุตุฑ ูุงุจูุงู ููู focus.|
|`onfocus=...`|ููุดุบู ุงูููุฏ ุนูุฏ ุงูุชุฑููุฒ ุนูู ุงูุนูุตุฑ.|
|`#x`|ููุฌุจุฑ ุงููุชุตูุญ ุนูู ุงูุชุฑููุฒ ุนูู ุงูุนูุตุฑ ุชููุงุฆููุง.|
|`location=`|ูุนูุฏ ุชูุฌูู ุงููุณุชุฎุฏู ุฅูู ุงูุฑุงุจุท ุงููุตุงุจ ุชููุงุฆููุง.|
