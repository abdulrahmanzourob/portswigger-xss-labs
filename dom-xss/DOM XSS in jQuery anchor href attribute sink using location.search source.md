# ๐ก๏ธ ููุงุญุธุงุช ุญู ุงููุงุจ

## 1. ูุนูููุงุช ุนุงูุฉ

| ุงูุนูุตุฑ         | ุงูุชูุงุตูู                                                                                                         |
| -------------- | ---------------------------------------------------------------------------------------------------------------- |
| **ุงูุฑุงุจุท**     | [ุฑุงุจุท ุงููุงุจ](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-href-attribute-sink) |
| **ุชุงุฑูุฎ ุงูุญู** | 27/4                                                                                                             |
| **ููุน ุงูุซุบุฑุฉ** | DOM-Based XSS                                                                                                    |

----
## 2. ูุตู ุงููุงุจ

ุงููุงุจ ูุญุชูู ุนูู ุซุบุฑุฉ DOM-Based XSS ูู ุตูุญุฉ ุฅุฑุณุงู ุงูุขุฑุงุก (Submit Feedback). ูุชู ุงุณุชุฎุฏุงู ููุชุจุฉ jQuery ูุชุญุฏูุฏ ุนูุตุฑ ุฑุงุจุท (Anchor) ูุชุบููุฑ ุณูุฉ `href` ุงูุฎุงุตุฉ ุจู ุจูุงุกู ุนูู ุจูุงูุงุช ูู `location.search` (ุงูุฌุฒุก ุงูุฎุงุต ุจุงูุจุงุฑุงูุชุฑุงุช ูู ุงูุฑุงุจุท).

ุงููุฏู: ุฌุนู ุฒุฑ "Back" ูููุฐ `alert(document.cookie)`.

![Screenshot](../images/Screenshot%202025-04-27%20011030.png)

ูุชูุงุญุธ ูู ุงูุตูุฑุฉ ุงููุง ุบูุฑูุง ุงููุณุงุฑ ู ุงุชุญุท ุฏุงุฎู ุงู `href`
```html
<a id="backLink" href="z3rob">Back</a>
```

ู ููุง ุชูุฌู ุจุงููุงูุณ ุนูู ุงู `Back` ูุชูุงูู ุงููููุฉ ุธูุฑุช ู ุงููุณุงุฑ ุชุญุช

---
## 3. ูุญุต ุงูููุฏ ุงููุตุฏุฑู (Source Code Review)

```html
<a id="backLink">Back</a>

<script>
ย $(function() {
ย ย const returnPath = (new URLSearchParams(window.location.search)).get('returnPath');
ย ย $('#backLink').attr("href", returnPath);
ย });
</script>
```
### ููุงุญุธุงุช ุนูู ุงูููุฏ:
- ูุชู ูุฑุงุกุฉ ุงูุจุงุฑุงูุชุฑ `returnPath` ูู ุงูุฑุงุจุท ุจุงุณุชุฎุฏุงู `location.search`.
- ูุชู ุงุณุชุฎุฏุงู ุฏุงูุฉ `$` ูู jQuery ูุชุญุฏูุฏ ุนูุตุฑ `<a>` ูุชุญุฏูุซ ุณูุฉ `href` ุจูููุฉ `returnPath` ูุจุงุดุฑุฉู ุจุฏูู ุชุนููู ุฃู ุชุฑููุฒ.

---
## 4. ููุฑุฉ ุงููุฌูู (Exploit Idea)

### ุงูุฎุทูุงุช ุงูุชูุตูููุฉ:
1. **ุชุญุฏูุฏ ุงูุจุงุฑุงูุชุฑ ุงูุถุนูู**: ุงูุจุงุฑุงูุชุฑ `returnPath` ูุชุญูู ูุจุงุดุฑุฉู ูู `href` ุงูุฎุงุต ุจุฑุงุจุท "Back".
2. **ุญูู JavaScript URI**: ุงุณุชุจุฏุงู ูููุฉ `returnPath` ุจู `javascript:alert(document.cookie)` ูุชูููุฐ ุงูููุฏ ุนูุฏ ุงูููุฑ ุนูู ุงูุฑุงุจุท.
3. **ุงูุชูููุฐ**: ุฅุฑุณุงู ุงูุฑุงุจุท ุงูููุญูู ููุถุญูุฉ ุฃู ุชุญุฏูุซ ุงูุตูุญุฉ ูุฏูููุง ุซู ุงูููุฑ ุนูู "Back".

### ูุซุงู ุงูุฑุงุจุท ุงููููุงุฌู:
```
https://vulnerable-lab.com/feedback?returnPath=javascript:alert(document.cookie)
```


---
## 6. ุงูููุงูุฉ (Prevention)

- **ุชุนููู ุงููุฏุฎูุงุช**: ุงุณุชุฎุฏุงู ุฏูุงู ูุซู `encodeURIComponent()` ุนูุฏ ุฅุฏุฎุงู ุจูุงูุงุช ุงููุณุชุฎุฏู ูู ุงูุณูุงุช.
- **ุงูุณูุงุช ุงูุขููุฉ**: ุชุฌูุจ ุงุณุชุฎุฏุงู `javascript:` ูู ุงูุณูุงุช ุงูุฏููุงููููุฉ ูุซู `href`.
- **Content Security Policy (CSP)**: ุชุทุจูู ุณูุงุณุฉ ุฃูุงู ุชููุน ุชูููุฐ ุงูููุฏ ุบูุฑ ุงูููุซูู.