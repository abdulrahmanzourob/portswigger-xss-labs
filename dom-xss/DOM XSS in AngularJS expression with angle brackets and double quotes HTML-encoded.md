## 1๏ธโฃ ูุนูููุงุช ุนุงูุฉ

| ุงูุนูุตุฑ         | ุงูุชูุงุตูู                                                                                                                                                                           |
| -------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ุฑุงุจุท ุงููุงุจ** | [DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression) |
| **ุชุงุฑูุฎ ุงูุญู** | 29 / 4 / 2025                                                                                                                                                                      |
| **ููุน ุงูุซุบุฑุฉ** | DOM Cross-Site Scripting (XSS)                                                                                                                                                     |

---

## 2๏ธโฃ ููู ุณููุงุฑูู ุงููุงุจ

- ุงููููุน ูุณุชุฎุฏู **AngularJS** ูุน ูุฌูุฏ ุฎุงุตูุฉ `ng-app`.
    
- ุนูุฏูุง ุชูุชุจ ุฃู ูุต ูู ูุฑุจุน ุงูุจุญุซุ ูุชู ุนุฑุถ ุงููุชุงุฆุฌ ุฏุงุฎู ุนูุตุฑ ูุฑุจูุท ุจู AngularJS.
    
- **ุฃู ูุฏุฎูุงุช** ูุชู ุนุฑุถูุง ุฏุงุฎู `{{ }}` ุชููุงุฆููุง ูุชู ุชูููููุง ูู **JavaScript Expression**.
    
- ุงููููุน **ูุนูู HTML encoding** ูุนูุงูุงุช ุงูุฒุงููุฉ `< >` ูุนูุงูุงุช ุงูุชูุตูุต `" "`ุ ูุฐูู ููููุน ุงุณุชุฎุฏุงู `<script>` ุฃู ุฃููุงุฏ HTML ุชูููุฏูุฉ.
    
- ูููู ุจุณุจุจ AngularJSุ **ุชูููู ุงูุชุนุจูุฑ ุฏุงุฎู {{ }}** ูุณูุญ ุจุชูููุฐ JavaScript ุจุฏูู ุงูุญุงุฌุฉ ูุนูุงูุงุช HTML ุฎุทูุฑุฉ.
    

---

### ๐ ุชุญููู ุงูููุฏ ุงููุตุฏุฑ (Source Code)

- ุนูุฏ ุฅุฏุฎุงู ูุต ูู ูุฑุจุน ุงูุจุญุซุ ูุชู ุชุฎุฒูู ูุฐุง ุงููุต ุฏุงุฎู ุฌุฒุก ุนููู `ng-app`:
    
    ูุซุงู ุชุฎููู:
    
    ```html
    <div ng-app>
      Search results for: {{ userInput }}
    </div>
    ```
    
- ูุจุงูุชุงููุ ุฃู ุดูุก ุชูุชุจู ูุชู ุฅุฏุฎุงูู ุฏุงุฎู `{{ }}` ููุชู ุชูุณูุฑู ูู AngularJS ูู ููุฏ.
    
- **ููุงุญุธุฉ**:
    
    - ูุชู ุชุฑููุฒ `<` ุฅูู `&lt;` ู`>` ุฅูู `&gt;`ุ ููุง ูููุนู ูู ูุชุญ `<script>`.
        
    - ูููู AngularJS ูุง ุชุนุชูุฏ ุนูู HTML tagsุ ุจู ุชุนุชูุฏ ุนูู ุงูุชุนุงุจูุฑ ุฏุงุฎู ุงูุฃููุงุณ `{{ }}`.
        

---

## 3๏ธโฃ ููุฑุฉ ุงููุฌูู (Exploit Idea)

|ุงูุฎุทูุฉ|ุงูุดุฑุญ|
|---|---|
|**1. ุงุณุชุบูุงู AngularJS**|ูุณุชุบู ูุฌูุฏ `ng-app` ูุชูููู ุชุนุจูุฑ ุจุฏุงุฎู ุงูุฃููุงุณ `{{ }}`.|
|**2. ุงุณุชุฎุฏุงู ุฏุงูุฉ ููุฌูุฏุฉ ($on)**|ูุณุชุฏุนู ุฏุงูุฉ ููุฌูุฏุฉ ุจุงููุนู ูู AngularJS ูุซู `$on` ุนุดุงู ููุตู ููู `constructor`.|
|**3. ุงููุตูู ุฅูู Function**|ูู ุฏุงูุฉ ูู JavaScript ุชููู ุฎุงุตูุฉ `.constructor`ุ ุงูุชู ูู ุงูุฏุงูุฉ `Function`.|
|**4. ุฅูุดุงุก ุฏุงูุฉ ุฌุฏูุฏุฉ**|ุจุงุณุชุฎุฏุงู `Function('alert(1)')` ูุตูุน ุฏุงูุฉ ุชููุฐ `alert(1)`.|
|**5. ุชูููุฐ ุงูุฏุงูุฉ**|ูุถุน `()` ุจุนุฏ ุงูู `Function` ุนุดุงู ูุชู ุชูููุฐ ุงูููุฏ ูุนูููุง.|

---

### โ ุงูุจุงูููุฏ ุงูููุงุฆู ุงููุณุชุฎุฏู:

```plaintext
{{$on.constructor('alert(1)')()}}
```

- `{{$on.constructor('alert(1)')()}}` ูููู ุจุงูุชุงูู:
    
    1. `$on` โ ุฏุงูุฉ ููุฌูุฏุฉ.
        
    2. `$on.constructor` โ ุงููุตูู ุฅูู ุงููุงุฆู `Function`.
        
    3. `Function('alert(1)')` โ ุฅูุดุงุก ุฏุงูุฉ ุฌุฏูุฏุฉ ุจุฏุงุฎููุง `alert(1)`.
        
    4. `Function('alert(1)')()` โ ุชูููุฐ ุงูุฏุงูุฉ ูุจุงุดุฑุฉ.
        

---

## โ ููุงุญุธุงุช ุฅุถุงููุฉ:

- ูู ูุงู ุงููููุน ุจูุณุชุฎุฏู **ูุณุฎุฉ AngularJS ุญุฏูุซุฉ** (ูุซูุงู 1.6 ุฃู ุฃุนูู) ูุน ุญูุงูุฉ ูุซู `strict contextual escaping (SCE)`ุ ูุฐุง ุงููุฌูู ุบุงูุจุงู ุณููุดู.
    
- ูุฐุง ุงูููุน ูู XSS ูุญุฏุซ ูุฃู AngularJS **ุชููู ุงูุชุนุจูุฑุงุช ูุจุงุดุฑุฉ** ุจุฏูู ุชุนููู ุฅุถุงูู.
    
- ุฏุงุฆููุง ูุญุงูู ูุจุญุซ ุนู ูุฌูุฏ `ng-app` ุฃู `ng-controller` ูุน ูุฏุฎูุงุช ุงููุณุชุฎุฏู ููุญุต ูุงุจููุฉ ุชูููุฐ ุชุนุจูุฑุงุช AngularJS.
    
- ูู ุฃูุถู ุทุฑู ุงูุญูุงูุฉ:
    
    - ุชุนุทูู ุงูุชูููู ุงูุชููุงุฆู (`$interpolateProvider`).
        
    - ุชูุนูู ูุถุน ุงูุญูุงูุฉ (`strict contextual escaping`).